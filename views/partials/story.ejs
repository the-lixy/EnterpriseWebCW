<!-- Template for displaying stories -->

<!-- script for allowing user to rate individual stories -->
 <script>
    document.addEventListener('DOMContentLoaded', () => {
        // Select every rating container on the page
        const ratingContainers = document.querySelectorAll('.rating-container');
    
        ratingContainers.forEach(container => {
          const stars = container.querySelectorAll('.rating-star');
    
          stars.forEach(star => {
            star.addEventListener('click', () => {
              const index = parseInt(star.dataset.index);
    
              // Remove 'checked' from all stars in this container
              stars.forEach(s => s.classList.remove('checked'));
    
              // Add 'checked' up to the clicked star
              for (let i = 0; i < index; i++) {
                stars[i].classList.add('checked');
              }
    
              console.log("Rated:", index);
            });
          });
        });
      });
 </script>

<div class="container">
    <% if (stories.length > 0) { %>
    <% stories.forEach(story => { %>
    <h4 style="display:inline"> <%= story.title %> </h4> <p style="display:inline"> by <%=story.author %> </p>
    <!-- genre & rating boxes -->
    <div class="row">

        <div class="col-sm-1"> 
            <p> <%= story.genre %> </p>
        </div>

        <div class="col-sm-11"> 
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star checked"></span>
            <span class="fa fa-star"></span> <br>
        </div>

    </div>
    <p> <%= story.story %> </p>

    <div class="rating-container">
        <%- include('../partials/rating'); %>
    </div>
    
    <br><br>

    <% }) %>
    <% } else { %>
      <p>No stories yet!</p>
    <% } %>

</div>